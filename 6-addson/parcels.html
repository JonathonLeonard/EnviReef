
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Particles tracking &#8212; Environmental Simulation Modelling</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Other libraries of interest" href="libraries.html" />
    <link rel="prev" title="PyViz Application" href="../5-xarray/examples/app.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo6.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Environmental Simulation Modelling</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Get started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-start/notebooks.html">
   Interactive notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1-start/environment.html">
   Managing environments
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../1-start/jupyter.html">
   Jupyter notebook
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../1-start/fundamentals.html">
     Python Fundamentals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1-start/functions.html">
     Python Functions and Classes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Model &amp; dataset
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../2-eReefs/model.html">
   eReefs model description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-eReefs/dataformat.html">
   Data formats and access
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Scientific Python Fundamentals
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../3-scientific/pythonstack.html">
   The scientific Python stack
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-scientific/numpy.html">
   Introduction to numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-scientific/matplotlib.html">
   Introduction to matplotlib
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../3-scientific/cartopy.html">
   Maps in Scientific Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../3-scientific/examples/hydro_maps.html">
     eReefs dataset maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-scientific/examples/cross_section.html">
     eReefs dataset cross section
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-scientific/examples/loadfct.html">
     eReefs plotting functions
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4-pandas/intro.html">
   Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-pandas/basic.html">
   Pandas Fundamentals
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../4-pandas/groupby.html">
   Pandas: Groupby
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../4-pandas/examples/site.html">
     Comparisons between Reefs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4-pandas/examples/climvar.html">
     Climate variability Davies Reef
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Multi-dimensional data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../5-xarray/intro.html">
   Xarray for multidimensional data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-xarray/basic.html">
   Xarray Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-xarray/advanced.html">
   Advanced Xarray
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../5-xarray/tips.html">
   Xarray Tips and Tricks
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../5-xarray/examples/davies.html">
     Xarray Davies Reef
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-xarray/examples/maps.html">
     Xarray maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-xarray/examples/interactive.html">
     Interactive maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-xarray/examples/box.html">
     Box streaming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-xarray/examples/app.html">
     PyViz Application
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Going further
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Particles tracking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="libraries.html">
   Other libraries of interest
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dask.html">
   Dask example
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6-addson/parcels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/TristanSalles/EnviReef"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/TristanSalles/EnviReef/issues/new?title=Issue%20on%20page%20%2F6-addson/parcels.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/TristanSalles/EnviReef/edit/main/book/6-addson/parcels.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/TristanSalles/EnviReef/main?urlpath=lab/tree/book/6-addson/parcels.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-required-python-libraries">
   Load the required Python libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-multi-file-dataset">
   Build multi-file dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-dataset-into-xarray">
     Loading dataset into xArray
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clip-the-dataset">
     Clip the Dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-velocities-into-parcels">
   Reading velocities into Parcels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-outputs">
   Plotting outputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-a-field-with-particles">
   Sampling a Field with Particles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-result">
     Plotting the result
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-distance-travelled">
   Calculating distance travelled
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Plotting the result
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="particles-tracking">
<h1>Particles tracking<a class="headerlink" href="#particles-tracking" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="http://oceanparcels.org">OceanParcels</a> project develops <code class="docutils literal notranslate"><span class="pre">Parcels</span></code> (<em>Probably A Really Computationally Efficient Lagrangian Simulator</em>), a set of Python classes and methods to create customisable particle tracking simulations using output from Ocean Circulation models such as the eReefs one.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parcels can be used to track passive and active particulates such as:</p>
<ul class="simple">
<li><p>water,</p></li>
<li><p>plankton,</p></li>
<li><p><a class="reference external" href="http://topios.org">plastic</a> and</p></li>
<li><p>fish.</p></li>
</ul>
</div>
<p>In this notebook, we will first cover how to run a set of <em>particles</em> from exported <a class="reference external" href="http://thredds.ereefs.aims.gov.au/thredds/catalog.html">eReefs data</a>. Then we will show how to use particles to sample a field such as <em>temperature</em> and how to write a kernel that tracks the <em>distance travelled by the particles</em>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference external" href="http://oceanparcels.org">OceanParcels</a> team has designed a series of Jupyter notebooks to help people to get started with <code class="docutils literal notranslate"><span class="pre">Parcels</span></code>. You can find the tutorials on this <a class="reference external" href="http://oceanparcels.org/#tutorials">link</a>!</p>
</div>
<div class="section" id="load-the-required-python-libraries">
<h2>Load the required Python libraries<a class="headerlink" href="#load-the-required-python-libraries" title="Permalink to this headline">¶</a></h2>
<p>First of all, load the necessary libraries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">cmocean</span>

<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">cartopy</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;data_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CARTOPY_DIR&#39;</span><span class="p">,</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_dir&#39;</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">parcels</span> <span class="kn">import</span> <span class="n">FieldSet</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">ParticleSet</span><span class="p">,</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">JITParticle</span>
<span class="kn">from</span> <span class="nn">parcels</span> <span class="kn">import</span> <span class="n">AdvectionRK4</span><span class="p">,</span> <span class="n">plotTrajectoriesFile</span><span class="p">,</span> <span class="n">ErrorCode</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">attrgetter</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1">#%config InlineBackend.figure_format = &#39;retina&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>  <span class="c1"># To trigger the interactive inline mode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Compiled ParcelsRandom ==&gt; /tmp/parcels-1001/libparcels_random_4cae6ef5-3eba-46fd-ab4f-692a1b6b577c.so
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="build-multi-file-dataset">
<h2>Build multi-file dataset<a class="headerlink" href="#build-multi-file-dataset" title="Permalink to this headline">¶</a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">open_mfdataset</span></code> function from <code class="docutils literal notranslate"><span class="pre">xArray</span></code> to open multiple netCDF files into a single xarray Dataset.</p>
<p>We will query load the GBR4km dataset from the <a class="reference external" href="http://thredds.ereefs.aims.gov.au/thredds/catalog.html">AIMS server</a>, so let’s first define the base URL:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For the hydro dataset</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;http://thredds.ereefs.aims.gov.au/thredds/dodsC/s3://aims-ereefs-public-prod/derived/ncaggregate/ereefs/gbr4_v2/daily-monthly/EREEFS_AIMS-CSIRO_gbr4_v2_hydro_daily-monthly-&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>For the sake of the demonstration, we will only use 1 month:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">month_st</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># Starting month </span>
<span class="n">month_ed</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># Ending month </span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span>    <span class="c1"># Year</span>

<span class="c1"># Based on the server the file naming convention </span>
<span class="n">hydrofiles</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">.nc&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">month_st</span><span class="p">,</span> <span class="n">month_ed</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loading-dataset-into-xarray">
<h3>Loading dataset into xArray<a class="headerlink" href="#loading-dataset-into-xarray" title="Permalink to this headline">¶</a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">xArray</span></code>, we open these files into a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_hydro</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">hydrofiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="clip-the-dataset">
<h3>Clip the Dataset<a class="headerlink" href="#clip-the-dataset" title="Permalink to this headline">¶</a></h3>
<p>To reduce the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> size we will clip the spatial extent based on longitudinal and latitudinal values.</p>
<p>This is easely done using the <code class="docutils literal notranslate"><span class="pre">sel</span></code> function with the <code class="docutils literal notranslate"><span class="pre">slice</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_lon</span> <span class="o">=</span> <span class="mi">146</span>     <span class="c1"># lower left longitude</span>
<span class="n">min_lat</span> <span class="o">=</span> <span class="o">-</span><span class="mi">21</span>     <span class="c1"># lower left latitude</span>
<span class="n">max_lon</span> <span class="o">=</span> <span class="mi">150</span>     <span class="c1"># upper right longitude</span>
<span class="n">max_lat</span> <span class="o">=</span> <span class="o">-</span><span class="mi">16</span>     <span class="c1"># upper right latitude</span>

<span class="c1"># Defining the boundaries</span>
<span class="n">lon_bnds</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">]</span>
<span class="n">lat_bnds</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">]</span>

<span class="c1"># Performing the reduction and only taking the surface dataset (k=-1)</span>
<span class="n">ds_hydro_clip</span> <span class="o">=</span> <span class="n">ds_hydro</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">lat_bnds</span><span class="p">),</span> <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">lon_bnds</span><span class="p">),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ds_hydro_clip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (latitude: 167, longitude: 134, time: 31)
Coordinates:
    zc           float64 dask.array&lt;chunksize=(), meta=np.ndarray&gt;
  * time         (time) datetime64[ns] 2017-12-31T14:00:00 ... 2018-01-30T14:...
  * latitude     (latitude) float64 -20.99 -20.96 -20.93 ... -16.04 -16.01
  * longitude    (longitude) float64 146.0 146.0 146.1 ... 149.9 150.0 150.0
Data variables:
    mean_cur     (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    salt         (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    temp         (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    u            (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    v            (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    mean_wspeed  (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    eta          (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    wspeed_u     (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    wspeed_v     (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
Attributes: (12/19)
    Conventions:                     CF-1.0
    Run_ID:                          2
    _CoordSysBuilder:                ucar.nc2.dataset.conv.CF1Convention
    aims_ncaggregate_buildDate:      2020-08-21T12:50:07+10:00
    aims_ncaggregate_datasetId:      products__ncaggregate__ereefs__gbr4_v2__...
    aims_ncaggregate_firstDate:      2018-01-01T00:00:00+10:00
    ...                              ...
    paramhead:                       GBR 4km resolution grid
    shoc_version:                    v1.1 rev(5620)
    technical_guide_link:            https://eatlas.org.au/pydio/public/aims-...
    technical_guide_publish_date:    2020-08-18
    title:                           eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 d...
    DODS_EXTRA.Unlimited_Dimension:  time</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a83822ec-8c22-4042-81d3-fd5bceccf8e0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a83822ec-8c22-4042-81d3-fd5bceccf8e0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 167</li><li><span class='xr-has-index'>longitude</span>: 134</li><li><span class='xr-has-index'>time</span>: 31</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fd511f99-a80d-406e-b372-7c2186d6a066' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fd511f99-a80d-406e-b372-7c2186d6a066' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>zc</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(), meta=np.ndarray&gt;</div><input id='attrs-78c15d7a-7b73-4b6b-96db-f1006cfaf349' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-78c15d7a-7b73-4b6b-96db-f1006cfaf349' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b411dbbc-a9c0-40aa-b40b-9008be62f4d5' class='xr-var-data-in' type='checkbox'><label for='data-b411dbbc-a9c0-40aa-b40b-9008be62f4d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>positive :</span></dt><dd>up</dd><dt><span>coordinate_type :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Z coordinate</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Height</dd><dt><span>_CoordinateZisPositive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 8 B </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> () </td> <td> () </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>

</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-12-31T14:00:00 ... 2018-01-...</div><input id='attrs-08d3654c-870a-45c2-bfaa-97f80ec86028' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-08d3654c-870a-45c2-bfaa-97f80ec86028' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24330653-8988-4cbf-acc7-2941d79f4bc2' class='xr-var-data-in' type='checkbox'><label for='data-24330653-8988-4cbf-acc7-2941d79f4bc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>coordinate_type :</span></dt><dd>time</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd><dt><span>_ChunkSizes :</span></dt><dd>1024</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2018-01-01T14:00:00.000000000&#x27;,
       &#x27;2018-01-02T14:00:00.000000000&#x27;, &#x27;2018-01-03T14:00:00.000000000&#x27;,
       &#x27;2018-01-04T14:00:00.000000000&#x27;, &#x27;2018-01-05T14:00:00.000000000&#x27;,
       &#x27;2018-01-06T14:00:00.000000000&#x27;, &#x27;2018-01-07T14:00:00.000000000&#x27;,
       &#x27;2018-01-08T14:00:00.000000000&#x27;, &#x27;2018-01-09T14:00:00.000000000&#x27;,
       &#x27;2018-01-10T14:00:00.000000000&#x27;, &#x27;2018-01-11T14:00:00.000000000&#x27;,
       &#x27;2018-01-12T14:00:00.000000000&#x27;, &#x27;2018-01-13T14:00:00.000000000&#x27;,
       &#x27;2018-01-14T14:00:00.000000000&#x27;, &#x27;2018-01-15T14:00:00.000000000&#x27;,
       &#x27;2018-01-16T14:00:00.000000000&#x27;, &#x27;2018-01-17T14:00:00.000000000&#x27;,
       &#x27;2018-01-18T14:00:00.000000000&#x27;, &#x27;2018-01-19T14:00:00.000000000&#x27;,
       &#x27;2018-01-20T14:00:00.000000000&#x27;, &#x27;2018-01-21T14:00:00.000000000&#x27;,
       &#x27;2018-01-22T14:00:00.000000000&#x27;, &#x27;2018-01-23T14:00:00.000000000&#x27;,
       &#x27;2018-01-24T14:00:00.000000000&#x27;, &#x27;2018-01-25T14:00:00.000000000&#x27;,
       &#x27;2018-01-26T14:00:00.000000000&#x27;, &#x27;2018-01-27T14:00:00.000000000&#x27;,
       &#x27;2018-01-28T14:00:00.000000000&#x27;, &#x27;2018-01-29T14:00:00.000000000&#x27;,
       &#x27;2018-01-30T14:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-20.99 -20.96 ... -16.04 -16.01</div><input id='attrs-400cf3ba-05b1-46b0-bc2c-3a63065d295c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-400cf3ba-05b1-46b0-bc2c-3a63065d295c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60100904-ee1d-435a-88e1-4e6efa25255c' class='xr-var-data-in' type='checkbox'><label for='data-60100904-ee1d-435a-88e1-4e6efa25255c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>coordinate_type :</span></dt><dd>latitude</dd><dt><span>projection :</span></dt><dd>geographic</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([-20.986022, -20.956022, -20.926022, -20.896022, -20.866022, -20.836022,
       -20.806022, -20.776022, -20.746022, -20.716022, -20.686022, -20.656022,
       -20.626022, -20.596022, -20.566022, -20.536022, -20.506022, -20.476022,
       -20.446022, -20.416022, -20.386022, -20.356022, -20.326022, -20.296022,
       -20.266022, -20.236022, -20.206022, -20.176022, -20.146022, -20.116022,
       -20.086022, -20.056022, -20.026022, -19.996022, -19.966022, -19.936022,
       -19.906022, -19.876022, -19.846022, -19.816022, -19.786022, -19.756022,
       -19.726022, -19.696022, -19.666022, -19.636022, -19.606022, -19.576022,
       -19.546022, -19.516022, -19.486022, -19.456022, -19.426022, -19.396022,
       -19.366022, -19.336022, -19.306022, -19.276022, -19.246022, -19.216022,
       -19.186022, -19.156022, -19.126022, -19.096022, -19.066022, -19.036022,
       -19.006022, -18.976022, -18.946022, -18.916022, -18.886022, -18.856022,
       -18.826022, -18.796022, -18.766022, -18.736022, -18.706022, -18.676022,
       -18.646022, -18.616022, -18.586022, -18.556022, -18.526022, -18.496022,
       -18.466022, -18.436022, -18.406022, -18.376022, -18.346022, -18.316022,
       -18.286022, -18.256022, -18.226022, -18.196022, -18.166022, -18.136022,
       -18.106022, -18.076022, -18.046022, -18.016022, -17.986022, -17.956022,
       -17.926022, -17.896022, -17.866022, -17.836022, -17.806022, -17.776022,
       -17.746022, -17.716022, -17.686022, -17.656022, -17.626022, -17.596022,
       -17.566022, -17.536022, -17.506022, -17.476022, -17.446022, -17.416022,
       -17.386022, -17.356022, -17.326022, -17.296022, -17.266022, -17.236022,
       -17.206022, -17.176022, -17.146022, -17.116022, -17.086022, -17.056022,
       -17.026022, -16.996022, -16.966022, -16.936022, -16.906022, -16.876022,
       -16.846022, -16.816022, -16.786022, -16.756022, -16.726022, -16.696022,
       -16.666022, -16.636022, -16.606022, -16.576022, -16.546022, -16.516022,
       -16.486022, -16.456022, -16.426022, -16.396022, -16.366022, -16.336022,
       -16.306022, -16.276022, -16.246022, -16.216022, -16.186022, -16.156022,
       -16.126022, -16.096022, -16.066022, -16.036022, -16.006022])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>146.0 146.0 146.1 ... 150.0 150.0</div><input id='attrs-aa984122-01ab-4b16-aab6-e7ad25f471aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa984122-01ab-4b16-aab6-e7ad25f471aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23cc2ecc-22eb-484b-ba48-726bf80dc8a9' class='xr-var-data-in' type='checkbox'><label for='data-23cc2ecc-22eb-484b-ba48-726bf80dc8a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>coordinate_type :</span></dt><dd>longitude</dd><dt><span>projection :</span></dt><dd>geographic</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([146.008788, 146.038788, 146.068788, 146.098788, 146.128788, 146.158788,
       146.188788, 146.218788, 146.248788, 146.278788, 146.308788, 146.338788,
       146.368788, 146.398788, 146.428788, 146.458788, 146.488788, 146.518788,
       146.548788, 146.578788, 146.608788, 146.638788, 146.668788, 146.698788,
       146.728788, 146.758788, 146.788788, 146.818788, 146.848788, 146.878788,
       146.908788, 146.938788, 146.968788, 146.998788, 147.028788, 147.058788,
       147.088788, 147.118788, 147.148788, 147.178788, 147.208788, 147.238788,
       147.268788, 147.298788, 147.328788, 147.358788, 147.388788, 147.418788,
       147.448788, 147.478788, 147.508788, 147.538788, 147.568788, 147.598788,
       147.628788, 147.658788, 147.688788, 147.718788, 147.748788, 147.778788,
       147.808788, 147.838788, 147.868788, 147.898788, 147.928788, 147.958788,
       147.988788, 148.018788, 148.048788, 148.078788, 148.108788, 148.138788,
       148.168788, 148.198788, 148.228788, 148.258788, 148.288788, 148.318788,
       148.348788, 148.378788, 148.408788, 148.438788, 148.468788, 148.498788,
       148.528788, 148.558788, 148.588788, 148.618788, 148.648788, 148.678788,
       148.708788, 148.738788, 148.768788, 148.798788, 148.828788, 148.858788,
       148.888788, 148.918788, 148.948788, 148.978788, 149.008788, 149.038788,
       149.068788, 149.098788, 149.128788, 149.158788, 149.188788, 149.218788,
       149.248788, 149.278788, 149.308788, 149.338788, 149.368788, 149.398788,
       149.428788, 149.458788, 149.488788, 149.518788, 149.548788, 149.578788,
       149.608788, 149.638788, 149.668788, 149.698788, 149.728788, 149.758788,
       149.788788, 149.818788, 149.848788, 149.878788, 149.908788, 149.938788,
       149.968788, 149.998788])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-788c3cbd-4cd8-4896-beb6-5a182ea09f4c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-788c3cbd-4cd8-4896-beb6-5a182ea09f4c' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mean_cur</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-1fff9ab8-7d61-4f00-ac90-d85ad5580434' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1fff9ab8-7d61-4f00-ac90-d85ad5580434' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-78b6f249-361d-4180-ae13-18350ec16644' class='xr-var-data-in' type='checkbox'><label for='data-78b6f249-361d-4180-ae13-18350ec16644' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_current</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#MeterPerSecond</dd><dt><span>short_name :</span></dt><dd>mean_cur</dd><dt><span>aggregation :</span></dt><dd>mean_speed</dd><dt><span>standard_name :</span></dt><dd>mean_current_speed</dd><dt><span>long_name :</span></dt><dd>mean_current_speed</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>salt</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-75a0d69e-d940-4417-ba04-14003ba4be62' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-75a0d69e-d940-4417-ba04-14003ba4be62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa948082-1106-48c3-a717-6cac70c804c0' class='xr-var-data-in' type='checkbox'><label for='data-aa948082-1106-48c3-a717-6cac70c804c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>substanceOrTaxon_id :</span></dt><dd>http://sweet.jpl.nasa.gov/2.2/matrWater.owl#SaltWater</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/practical_salinity</dd><dt><span>short_name :</span></dt><dd>salt</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>PSU</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://environment.data.gov.au/water/quality/def/unit/PSU</dd><dt><span>long_name :</span></dt><dd>Salinity</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temp</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-238a3824-da23-426d-8489-6bbd9f8750ed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-238a3824-da23-426d-8489-6bbd9f8750ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd98e1bd-977a-4c03-a409-caec10e953f3' class='xr-var-data-in' type='checkbox'><label for='data-dd98e1bd-977a-4c03-a409-caec10e953f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>substanceOrTaxon_id :</span></dt><dd>http://sweet.jpl.nasa.gov/2.2/matrWater.owl#SaltWater</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_temperature</dd><dt><span>short_name :</span></dt><dd>temp</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>degrees C</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#DegreeCelsius</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-0c685d04-bd2a-41ed-acbe-7ed6e34f993b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c685d04-bd2a-41ed-acbe-7ed6e34f993b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ab3cef1-9973-4205-b3f0-d64af9ac43f4' class='xr-var-data-in' type='checkbox'><label for='data-3ab3cef1-9973-4205-b3f0-d64af9ac43f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>vector_components :</span></dt><dd>u v</dd><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_current</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_velocity_eastward</dd><dt><span>short_name :</span></dt><dd>u</dd><dt><span>vector_name :</span></dt><dd>Currents</dd><dt><span>standard_name :</span></dt><dd>eastward_sea_water_velocity</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#MeterPerSecond</dd><dt><span>long_name :</span></dt><dd>Eastward current</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-3bef456d-32fd-4794-a012-e932b9556b44' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3bef456d-32fd-4794-a012-e932b9556b44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6dc9a477-8531-4af7-a591-35ca6e0359a4' class='xr-var-data-in' type='checkbox'><label for='data-6dc9a477-8531-4af7-a591-35ca6e0359a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>vector_components :</span></dt><dd>u v</dd><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_current</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_velocity_northward</dd><dt><span>short_name :</span></dt><dd>v</dd><dt><span>vector_name :</span></dt><dd>Currents</dd><dt><span>standard_name :</span></dt><dd>northward_sea_water_velocity</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#MeterPerSecond</dd><dt><span>long_name :</span></dt><dd>Northward current</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mean_wspeed</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-e9b59d57-439b-43fe-bee6-2c4c576f37e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e9b59d57-439b-43fe-bee6-2c4c576f37e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2034c0ba-a303-423c-ad6c-539280ed15c4' class='xr-var-data-in' type='checkbox'><label for='data-2034c0ba-a303-423c-ad6c-539280ed15c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>short_name :</span></dt><dd>mean_wspeed</dd><dt><span>aggregation :</span></dt><dd>mean_speed</dd><dt><span>standard_name :</span></dt><dd>mean_wind_speed</dd><dt><span>long_name :</span></dt><dd>mean_wind_speed</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>eta</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-6d7cb11b-b820-49bc-97e0-cd2cfbe3fb14' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6d7cb11b-b820-49bc-97e0-cd2cfbe3fb14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-16bf7ea9-2a5b-418f-b57a-8126246a6f91' class='xr-var-data-in' type='checkbox'><label for='data-16bf7ea9-2a5b-418f-b57a-8126246a6f91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_near_surface</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_surface_elevation</dd><dt><span>short_name :</span></dt><dd>eta</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>metre</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#Meter</dd><dt><span>long_name :</span></dt><dd>Surface elevation</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wspeed_u</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-b857832a-ed89-42b8-ae6b-f9123a3c5f61' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b857832a-ed89-42b8-ae6b-f9123a3c5f61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2d18c33-5904-4225-88e5-34e8b4bd1844' class='xr-var-data-in' type='checkbox'><label for='data-b2d18c33-5904-4225-88e5-34e8b4bd1844' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>short_name :</span></dt><dd>wspeed_u</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>long_name :</span></dt><dd>eastward_wind</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wspeed_v</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-3d9a76e9-fb27-44c1-b8f0-0569163acaef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3d9a76e9-fb27-44c1-b8f0-0569163acaef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2f51d9b-400b-40eb-9cd1-2d0d743ddf98' class='xr-var-data-in' type='checkbox'><label for='data-d2f51d9b-400b-40eb-9cd1-2d0d743ddf98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>short_name :</span></dt><dd>wspeed_v</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>long_name :</span></dt><dd>northward_wind</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-5a0ac96e-2dc4-4019-a12b-216f2bb7d9ef' class='xr-section-summary-in' type='checkbox'  ><label for='section-5a0ac96e-2dc4-4019-a12b-216f2bb7d9ef' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.0</dd><dt><span>Run_ID :</span></dt><dd>2</dd><dt><span>_CoordSysBuilder :</span></dt><dd>ucar.nc2.dataset.conv.CF1Convention</dd><dt><span>aims_ncaggregate_buildDate :</span></dt><dd>2020-08-21T12:50:07+10:00</dd><dt><span>aims_ncaggregate_datasetId :</span></dt><dd>products__ncaggregate__ereefs__gbr4_v2__daily-monthly/EREEFS_AIMS-CSIRO_gbr4_v2_hydro_daily-monthly-2018-01</dd><dt><span>aims_ncaggregate_firstDate :</span></dt><dd>2018-01-01T00:00:00+10:00</dd><dt><span>aims_ncaggregate_inputs :</span></dt><dd>[products__ncaggregate__ereefs__gbr4_v2__raw/EREEFS_AIMS-CSIRO_gbr4_v2_hydro_raw_2018-01::MD5:f3d285e0aaa945e64825e628387ac6d0]</dd><dt><span>aims_ncaggregate_lastDate :</span></dt><dd>2018-01-31T00:00:00+10:00</dd><dt><span>description :</span></dt><dd>Aggregation of raw hourly input data (from eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 subset) to daily means. Also calculates mean magnitude of wind and ocean current speeds. Data is regridded from curvilinear (per input data) to rectilinear via inverse weighted distance from up to 4 closest cells.</dd><dt><span>hasVocab :</span></dt><dd>1</dd><dt><span>history :</span></dt><dd>2020-08-20T12:56:06+10:00: vendor: AIMS; processing: None summaries
2020-08-21T12:50:07+10:00: vendor: AIMS; processing: Daily summaries</dd><dt><span>metadata_link :</span></dt><dd>https://eatlas.org.au/data/uuid/350aed53-ae0f-436e-9866-d34db7f04d2e</dd><dt><span>paramfile :</span></dt><dd>in.prm</dd><dt><span>paramhead :</span></dt><dd>GBR 4km resolution grid</dd><dt><span>shoc_version :</span></dt><dd>v1.1 rev(5620)</dd><dt><span>technical_guide_link :</span></dt><dd>https://eatlas.org.au/pydio/public/aims-ereefs-platform-technical-guide-to-derived-products-from-csiro-ereefs-models-pdf</dd><dt><span>technical_guide_publish_date :</span></dt><dd>2020-08-18</dd><dt><span>title :</span></dt><dd>eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 daily aggregation</dd><dt><span>DODS_EXTRA.Unlimited_Dimension :</span></dt><dd>time</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We will now drop all unnecessary variables.</p>
<p>Basically we will only need the current velocities (<code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code>) and the variable we want to track with the parcels (here <code class="docutils literal notranslate"><span class="pre">temp</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">surf_data</span> <span class="o">=</span> <span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;zc&#39;</span><span class="p">,</span><span class="s1">&#39;mean_wspeed&#39;</span><span class="p">,</span><span class="s1">&#39;salt&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;eta&#39;</span><span class="p">,</span><span class="s1">&#39;wspeed_u&#39;</span><span class="p">,</span><span class="s1">&#39;wspeed_v&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;mean_cur&#39;</span><span class="p">])</span>

<span class="n">surf_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 167, longitude: 134, time: 31)
Coordinates:
  * time       (time) datetime64[ns] 2017-12-31T14:00:00 ... 2018-01-30T14:00:00
  * latitude   (latitude) float64 -20.99 -20.96 -20.93 ... -16.07 -16.04 -16.01
  * longitude  (longitude) float64 146.0 146.0 146.1 146.1 ... 149.9 150.0 150.0
Data variables:
    temp       (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    u          (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
    v          (time, latitude, longitude) float32 dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;
Attributes: (12/19)
    Conventions:                     CF-1.0
    Run_ID:                          2
    _CoordSysBuilder:                ucar.nc2.dataset.conv.CF1Convention
    aims_ncaggregate_buildDate:      2020-08-21T12:50:07+10:00
    aims_ncaggregate_datasetId:      products__ncaggregate__ereefs__gbr4_v2__...
    aims_ncaggregate_firstDate:      2018-01-01T00:00:00+10:00
    ...                              ...
    paramhead:                       GBR 4km resolution grid
    shoc_version:                    v1.1 rev(5620)
    technical_guide_link:            https://eatlas.org.au/pydio/public/aims-...
    technical_guide_publish_date:    2020-08-18
    title:                           eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 d...
    DODS_EXTRA.Unlimited_Dimension:  time</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f1de2287-307d-4942-b2cd-e407a26596c4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f1de2287-307d-4942-b2cd-e407a26596c4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 167</li><li><span class='xr-has-index'>longitude</span>: 134</li><li><span class='xr-has-index'>time</span>: 31</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f033a9c9-9f0c-4c83-a499-5a7dae53c550' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f033a9c9-9f0c-4c83-a499-5a7dae53c550' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-12-31T14:00:00 ... 2018-01-...</div><input id='attrs-56a313ec-7195-4124-b514-f4d2952d032c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-56a313ec-7195-4124-b514-f4d2952d032c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd364fef-7eba-4d2d-b7e0-cfe90e0cda14' class='xr-var-data-in' type='checkbox'><label for='data-bd364fef-7eba-4d2d-b7e0-cfe90e0cda14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>coordinate_type :</span></dt><dd>time</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd><dt><span>_ChunkSizes :</span></dt><dd>1024</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2018-01-01T14:00:00.000000000&#x27;,
       &#x27;2018-01-02T14:00:00.000000000&#x27;, &#x27;2018-01-03T14:00:00.000000000&#x27;,
       &#x27;2018-01-04T14:00:00.000000000&#x27;, &#x27;2018-01-05T14:00:00.000000000&#x27;,
       &#x27;2018-01-06T14:00:00.000000000&#x27;, &#x27;2018-01-07T14:00:00.000000000&#x27;,
       &#x27;2018-01-08T14:00:00.000000000&#x27;, &#x27;2018-01-09T14:00:00.000000000&#x27;,
       &#x27;2018-01-10T14:00:00.000000000&#x27;, &#x27;2018-01-11T14:00:00.000000000&#x27;,
       &#x27;2018-01-12T14:00:00.000000000&#x27;, &#x27;2018-01-13T14:00:00.000000000&#x27;,
       &#x27;2018-01-14T14:00:00.000000000&#x27;, &#x27;2018-01-15T14:00:00.000000000&#x27;,
       &#x27;2018-01-16T14:00:00.000000000&#x27;, &#x27;2018-01-17T14:00:00.000000000&#x27;,
       &#x27;2018-01-18T14:00:00.000000000&#x27;, &#x27;2018-01-19T14:00:00.000000000&#x27;,
       &#x27;2018-01-20T14:00:00.000000000&#x27;, &#x27;2018-01-21T14:00:00.000000000&#x27;,
       &#x27;2018-01-22T14:00:00.000000000&#x27;, &#x27;2018-01-23T14:00:00.000000000&#x27;,
       &#x27;2018-01-24T14:00:00.000000000&#x27;, &#x27;2018-01-25T14:00:00.000000000&#x27;,
       &#x27;2018-01-26T14:00:00.000000000&#x27;, &#x27;2018-01-27T14:00:00.000000000&#x27;,
       &#x27;2018-01-28T14:00:00.000000000&#x27;, &#x27;2018-01-29T14:00:00.000000000&#x27;,
       &#x27;2018-01-30T14:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-20.99 -20.96 ... -16.04 -16.01</div><input id='attrs-a24a6ed1-4765-44fd-b7a0-8b91e508cc6d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a24a6ed1-4765-44fd-b7a0-8b91e508cc6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a6a03d0-d76c-4efe-b16f-0d7acc9a64f3' class='xr-var-data-in' type='checkbox'><label for='data-2a6a03d0-d76c-4efe-b16f-0d7acc9a64f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>coordinate_type :</span></dt><dd>latitude</dd><dt><span>projection :</span></dt><dd>geographic</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([-20.986022, -20.956022, -20.926022, -20.896022, -20.866022, -20.836022,
       -20.806022, -20.776022, -20.746022, -20.716022, -20.686022, -20.656022,
       -20.626022, -20.596022, -20.566022, -20.536022, -20.506022, -20.476022,
       -20.446022, -20.416022, -20.386022, -20.356022, -20.326022, -20.296022,
       -20.266022, -20.236022, -20.206022, -20.176022, -20.146022, -20.116022,
       -20.086022, -20.056022, -20.026022, -19.996022, -19.966022, -19.936022,
       -19.906022, -19.876022, -19.846022, -19.816022, -19.786022, -19.756022,
       -19.726022, -19.696022, -19.666022, -19.636022, -19.606022, -19.576022,
       -19.546022, -19.516022, -19.486022, -19.456022, -19.426022, -19.396022,
       -19.366022, -19.336022, -19.306022, -19.276022, -19.246022, -19.216022,
       -19.186022, -19.156022, -19.126022, -19.096022, -19.066022, -19.036022,
       -19.006022, -18.976022, -18.946022, -18.916022, -18.886022, -18.856022,
       -18.826022, -18.796022, -18.766022, -18.736022, -18.706022, -18.676022,
       -18.646022, -18.616022, -18.586022, -18.556022, -18.526022, -18.496022,
       -18.466022, -18.436022, -18.406022, -18.376022, -18.346022, -18.316022,
       -18.286022, -18.256022, -18.226022, -18.196022, -18.166022, -18.136022,
       -18.106022, -18.076022, -18.046022, -18.016022, -17.986022, -17.956022,
       -17.926022, -17.896022, -17.866022, -17.836022, -17.806022, -17.776022,
       -17.746022, -17.716022, -17.686022, -17.656022, -17.626022, -17.596022,
       -17.566022, -17.536022, -17.506022, -17.476022, -17.446022, -17.416022,
       -17.386022, -17.356022, -17.326022, -17.296022, -17.266022, -17.236022,
       -17.206022, -17.176022, -17.146022, -17.116022, -17.086022, -17.056022,
       -17.026022, -16.996022, -16.966022, -16.936022, -16.906022, -16.876022,
       -16.846022, -16.816022, -16.786022, -16.756022, -16.726022, -16.696022,
       -16.666022, -16.636022, -16.606022, -16.576022, -16.546022, -16.516022,
       -16.486022, -16.456022, -16.426022, -16.396022, -16.366022, -16.336022,
       -16.306022, -16.276022, -16.246022, -16.216022, -16.186022, -16.156022,
       -16.126022, -16.096022, -16.066022, -16.036022, -16.006022])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>146.0 146.0 146.1 ... 150.0 150.0</div><input id='attrs-89bc9587-cc9f-4bbc-ad62-79ccd20f424f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-89bc9587-cc9f-4bbc-ad62-79ccd20f424f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11d37dbb-6473-4bc5-927d-219e5c359678' class='xr-var-data-in' type='checkbox'><label for='data-11d37dbb-6473-4bc5-927d-219e5c359678' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>coordinate_type :</span></dt><dd>longitude</dd><dt><span>projection :</span></dt><dd>geographic</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([146.008788, 146.038788, 146.068788, 146.098788, 146.128788, 146.158788,
       146.188788, 146.218788, 146.248788, 146.278788, 146.308788, 146.338788,
       146.368788, 146.398788, 146.428788, 146.458788, 146.488788, 146.518788,
       146.548788, 146.578788, 146.608788, 146.638788, 146.668788, 146.698788,
       146.728788, 146.758788, 146.788788, 146.818788, 146.848788, 146.878788,
       146.908788, 146.938788, 146.968788, 146.998788, 147.028788, 147.058788,
       147.088788, 147.118788, 147.148788, 147.178788, 147.208788, 147.238788,
       147.268788, 147.298788, 147.328788, 147.358788, 147.388788, 147.418788,
       147.448788, 147.478788, 147.508788, 147.538788, 147.568788, 147.598788,
       147.628788, 147.658788, 147.688788, 147.718788, 147.748788, 147.778788,
       147.808788, 147.838788, 147.868788, 147.898788, 147.928788, 147.958788,
       147.988788, 148.018788, 148.048788, 148.078788, 148.108788, 148.138788,
       148.168788, 148.198788, 148.228788, 148.258788, 148.288788, 148.318788,
       148.348788, 148.378788, 148.408788, 148.438788, 148.468788, 148.498788,
       148.528788, 148.558788, 148.588788, 148.618788, 148.648788, 148.678788,
       148.708788, 148.738788, 148.768788, 148.798788, 148.828788, 148.858788,
       148.888788, 148.918788, 148.948788, 148.978788, 149.008788, 149.038788,
       149.068788, 149.098788, 149.128788, 149.158788, 149.188788, 149.218788,
       149.248788, 149.278788, 149.308788, 149.338788, 149.368788, 149.398788,
       149.428788, 149.458788, 149.488788, 149.518788, 149.548788, 149.578788,
       149.608788, 149.638788, 149.668788, 149.698788, 149.728788, 149.758788,
       149.788788, 149.818788, 149.848788, 149.878788, 149.908788, 149.938788,
       149.968788, 149.998788])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6af073ab-f949-4e35-b3ab-dfb0f6a37aba' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6af073ab-f949-4e35-b3ab-dfb0f6a37aba' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>temp</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-d224f96f-3817-4659-88b6-a35e30c29809' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d224f96f-3817-4659-88b6-a35e30c29809' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf355e0e-c1c7-4e26-9d10-fd4ed184f8ee' class='xr-var-data-in' type='checkbox'><label for='data-cf355e0e-c1c7-4e26-9d10-fd4ed184f8ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>substanceOrTaxon_id :</span></dt><dd>http://sweet.jpl.nasa.gov/2.2/matrWater.owl#SaltWater</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_temperature</dd><dt><span>short_name :</span></dt><dd>temp</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>degrees C</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#DegreeCelsius</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-165a87bf-4354-4d4f-93ac-9405b317d9dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-165a87bf-4354-4d4f-93ac-9405b317d9dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48c5a618-9f86-4e1f-9eb1-09d09cb54979' class='xr-var-data-in' type='checkbox'><label for='data-48c5a618-9f86-4e1f-9eb1-09d09cb54979' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>vector_components :</span></dt><dd>u v</dd><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_current</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_velocity_eastward</dd><dt><span>short_name :</span></dt><dd>u</dd><dt><span>vector_name :</span></dt><dd>Currents</dd><dt><span>standard_name :</span></dt><dd>eastward_sea_water_velocity</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#MeterPerSecond</dd><dt><span>long_name :</span></dt><dd>Eastward current</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31, 167, 134), meta=np.ndarray&gt;</div><input id='attrs-515185a5-195e-425f-87b0-59e9ef774d5c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-515185a5-195e-425f-87b0-59e9ef774d5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b07eadf3-228c-447c-aefc-b02c14bda4a9' class='xr-var-data-in' type='checkbox'><label for='data-b07eadf3-228c-447c-aefc-b02c14bda4a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>vector_components :</span></dt><dd>u v</dd><dt><span>substanceOrTaxon_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean_current</dd><dt><span>scaledQuantityKind_id :</span></dt><dd>http://environment.data.gov.au/def/property/sea_water_velocity_northward</dd><dt><span>short_name :</span></dt><dd>v</dd><dt><span>vector_name :</span></dt><dd>Currents</dd><dt><span>standard_name :</span></dt><dd>northward_sea_water_velocity</dd><dt><span>aggregation :</span></dt><dd>Daily</dd><dt><span>units :</span></dt><dd>ms-1</dd><dt><span>medium_id :</span></dt><dd>http://environment.data.gov.au/def/feature/ocean</dd><dt><span>unit_id :</span></dt><dd>http://qudt.org/vocab/unit#MeterPerSecond</dd><dt><span>long_name :</span></dt><dd>Northward current</dd><dt><span>_ChunkSizes :</span></dt><dd>[  1   1 133 491]</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.77 MB </td> <td> 2.77 MB </td></tr>
    <tr><th> Shape </th><td> (31, 167, 134) </td> <td> (31, 167, 134) </td></tr>
    <tr><th> Count </th><td> 3 Tasks </td><td> 1 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="180" height="194" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="10" y1="120" x2="34" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 34.52280361214072,24.522803612140716 34.52280361214072,144.5228036121407 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="106" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="34" y2="24" style="stroke-width:2" />
  <line x1="106" y1="0" x2="130" y2="24" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 106.28742514970061,0.0 130.81022876184133,24.522803612140716 34.52280361214072,24.522803612140716" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="34" y1="24" x2="130" y2="24" style="stroke-width:2" />
  <line x1="34" y1="144" x2="130" y2="144" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="34" y1="24" x2="34" y2="144" style="stroke-width:2" />
  <line x1="130" y1="24" x2="130" y2="144" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="34.52280361214072,24.522803612140716 130.81022876184133,24.522803612140716 130.81022876184133,144.5228036121407 34.52280361214072,144.5228036121407" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="82.666516" y="164.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" >134</text>
  <text x="150.810229" y="84.522804" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.810229,84.522804)">167</text>
  <text x="12.261402" y="152.261402" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,12.261402,152.261402)">31</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-9224eb50-7854-4c3b-890d-4ade3c661f36' class='xr-section-summary-in' type='checkbox'  ><label for='section-9224eb50-7854-4c3b-890d-4ade3c661f36' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.0</dd><dt><span>Run_ID :</span></dt><dd>2</dd><dt><span>_CoordSysBuilder :</span></dt><dd>ucar.nc2.dataset.conv.CF1Convention</dd><dt><span>aims_ncaggregate_buildDate :</span></dt><dd>2020-08-21T12:50:07+10:00</dd><dt><span>aims_ncaggregate_datasetId :</span></dt><dd>products__ncaggregate__ereefs__gbr4_v2__daily-monthly/EREEFS_AIMS-CSIRO_gbr4_v2_hydro_daily-monthly-2018-01</dd><dt><span>aims_ncaggregate_firstDate :</span></dt><dd>2018-01-01T00:00:00+10:00</dd><dt><span>aims_ncaggregate_inputs :</span></dt><dd>[products__ncaggregate__ereefs__gbr4_v2__raw/EREEFS_AIMS-CSIRO_gbr4_v2_hydro_raw_2018-01::MD5:f3d285e0aaa945e64825e628387ac6d0]</dd><dt><span>aims_ncaggregate_lastDate :</span></dt><dd>2018-01-31T00:00:00+10:00</dd><dt><span>description :</span></dt><dd>Aggregation of raw hourly input data (from eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 subset) to daily means. Also calculates mean magnitude of wind and ocean current speeds. Data is regridded from curvilinear (per input data) to rectilinear via inverse weighted distance from up to 4 closest cells.</dd><dt><span>hasVocab :</span></dt><dd>1</dd><dt><span>history :</span></dt><dd>2020-08-20T12:56:06+10:00: vendor: AIMS; processing: None summaries
2020-08-21T12:50:07+10:00: vendor: AIMS; processing: Daily summaries</dd><dt><span>metadata_link :</span></dt><dd>https://eatlas.org.au/data/uuid/350aed53-ae0f-436e-9866-d34db7f04d2e</dd><dt><span>paramfile :</span></dt><dd>in.prm</dd><dt><span>paramhead :</span></dt><dd>GBR 4km resolution grid</dd><dt><span>shoc_version :</span></dt><dd>v1.1 rev(5620)</dd><dt><span>technical_guide_link :</span></dt><dd>https://eatlas.org.au/pydio/public/aims-ereefs-platform-technical-guide-to-derived-products-from-csiro-ereefs-models-pdf</dd><dt><span>technical_guide_publish_date :</span></dt><dd>2020-08-18</dd><dt><span>title :</span></dt><dd>eReefs AIMS-CSIRO GBR4 Hydrodynamic v2 daily aggregation</dd><dt><span>DODS_EXTRA.Unlimited_Dimension :</span></dt><dd>time</dd></dl></div></li></ul></div></div></div></div>
</div>
<p><a class="reference external" href="http://oceanparcels.org">OceanParcels</a> will need to read the file locally and we save it using the <code class="docutils literal notranslate"><span class="pre">Xarray</span></code> funciton <code class="docutils literal notranslate"><span class="pre">to_netcdf</span></code>. Otherwise you could use the <code class="docutils literal notranslate"><span class="pre">from_xarray_dataset</span></code> function to directly read the dataset in <code class="docutils literal notranslate"><span class="pre">Parcels</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here the cell has been commented to make the notebook run faster, but you will need to uncomment it for running your how experiment…</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_name</span> <span class="o">=</span><span class="s1">&#39;ereefdata.nc&#39;</span>
<span class="c1"># try:</span>
<span class="c1">#     os.remove(data_name)</span>
<span class="c1"># except OSError:</span>
<span class="c1">#     pass</span>

<span class="c1"># surf_data.to_netcdf(path=data_name)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="reading-velocities-into-parcels">
<h2>Reading velocities into Parcels<a class="headerlink" href="#reading-velocities-into-parcels" title="Permalink to this headline">¶</a></h2>
<p>As we used the <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> format, it is fairly easy to load the velocity fields into the <code class="docutils literal notranslate"><span class="pre">FieldSet.from_netcdf()</span></code> function available in <code class="docutils literal notranslate"><span class="pre">Parcels</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Then, define a dictionary of the variables (<code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code>) and dimensions (<code class="docutils literal notranslate"><span class="pre">lon</span></code>, <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>; note that in this case there is no depth because we only took the surface variables from the <code class="docutils literal notranslate"><span class="pre">eReefs</span></code> datastet:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="s1">&#39;v&#39;</span><span class="p">}</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we read in the fieldset using the <code class="docutils literal notranslate"><span class="pre">FieldSet.from_netcdf</span></code> function with the above-defined <code class="docutils literal notranslate"><span class="pre">filenames</span></code>, <code class="docutils literal notranslate"><span class="pre">variables</span></code> and <code class="docutils literal notranslate"><span class="pre">dimensions</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fieldset</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Casting lon data to np.float32
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Casting lat data to np.float32
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Casting depth data to np.float32
</pre></div>
</div>
</div>
</div>
<p>Now define a <code class="docutils literal notranslate"><span class="pre">ParticleSet</span></code>, in this case with 5 particles starting on a line between (147E, 18.5S) and (148E, 17.5S) using the <code class="docutils literal notranslate"><span class="pre">ParticleSet.from_line</span></code> constructor method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pset</span> <span class="o">=</span> <span class="n">ParticleSet</span><span class="o">.</span><span class="n">from_line</span><span class="p">(</span><span class="n">fieldset</span><span class="o">=</span><span class="n">fieldset</span><span class="p">,</span> <span class="n">pclass</span><span class="o">=</span><span class="n">JITParticle</span><span class="p">,</span>
                             <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>               <span class="c1"># releasing 5 particles</span>
                             <span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mi">147</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.5</span><span class="p">),</span>   <span class="c1"># releasing on a line: the start longitude and latitude</span>
                             <span class="n">finish</span><span class="o">=</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.5</span><span class="p">))</span>  <span class="c1"># releasing on a line: the end longitude and latitude</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another approach if you want to list a series of initial positions consists in using the <code class="docutils literal notranslate"><span class="pre">from_list</span></code> <a class="reference external" href="https://oceanparcels.org/gh-pages/html/#module-parcels.particlesets.particlesetsoa">function</a> which takes:</p>
<ul class="simple">
<li><p>lon – List of initial longitude values for particles</p></li>
<li><p>lat – List of initial latitude values for particles</p></li>
</ul>
</div>
<p>Now we want to advect the particles. However, the eReefs data that we loaded in is only for a limited, regional domain and particles might be able to leave this domain.</p>
<p>We therefore need to tell <code class="docutils literal notranslate"><span class="pre">Parcels</span></code> that particles that leave the domain need to be deleted. We do that using a <code class="docutils literal notranslate"><span class="pre">Recovery</span> <span class="pre">Kernel</span></code>, which will be invoked when a particle encounters an <code class="docutils literal notranslate"><span class="pre">ErrorOutOfBounds</span> <span class="pre">error</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">DeleteParticle</span><span class="p">(</span><span class="n">particle</span><span class="p">,</span> <span class="n">fieldset</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can advect the particles by executing the ParticleSet for 30 days using 4th order Runge-Kutta (<code class="docutils literal notranslate"><span class="pre">AdvectionRK4</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_nc</span> <span class="o">=</span> <span class="s1">&#39;CurrentParticles.nc&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">output_nc</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_file</span> <span class="o">=</span> <span class="n">pset</span><span class="o">.</span><span class="n">ParticleFile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">output_nc</span><span class="p">,</span> 
                                <span class="n">outputdt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>

<span class="n">pset</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AdvectionRK4</span><span class="p">,</span>
             <span class="n">runtime</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
             <span class="n">dt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
             <span class="n">recovery</span><span class="o">=</span><span class="p">{</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">ErrorOutOfBounds</span><span class="p">:</span> <span class="n">DeleteParticle</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Compiled JITParticleAdvectionRK4 ==&gt; /tmp/parcels-1001/0afc2149946c974dbfdf33957dcb4b68_0.so
</pre></div>
</div>
</div>
</div>
<p>We now export the particles recorded every 6h in our output file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_file</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-outputs">
<h2>Plotting outputs<a class="headerlink" href="#plotting-outputs" title="Permalink to this headline">¶</a></h2>
<p>We open the particles file with <code class="docutils literal notranslate"><span class="pre">Xarray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parcels</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">output_nc</span><span class="p">)</span>
<span class="n">parcels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (obs: 121, traj: 5)
Dimensions without coordinates: obs, traj
Data variables:
    trajectory  (traj, obs) float64 0.0 0.0 0.0 0.0 0.0 ... 4.0 4.0 4.0 4.0 4.0
    time        (traj, obs) datetime64[ns] 2017-12-31T14:00:00 ... 2018-01-30...
    lat         (traj, obs) float32 -18.5 -18.54 -18.57 ... -18.79 -18.8 -18.82
    lon         (traj, obs) float32 147.0 147.0 147.1 ... 146.8 146.8 146.9
    z           (traj, obs) float32 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0
Attributes:
    feature_type:           trajectory
    Conventions:            CF-1.6/CF-1.7
    ncei_template_version:  NCEI_NetCDF_Trajectory_Template_v2.0
    parcels_version:        2.2.2
    parcels_mesh:           spherical</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e8fd85b2-293a-42d9-a7a5-feabbb1e6ff4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e8fd85b2-293a-42d9-a7a5-feabbb1e6ff4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>obs</span>: 121</li><li><span>traj</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d949b745-8b73-4f93-a8dd-b37c02e80b8f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d949b745-8b73-4f93-a8dd-b37c02e80b8f' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-adf93ace-5538-4aa9-9da2-2ae12334d30e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-adf93ace-5538-4aa9-9da2-2ae12334d30e' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>trajectory</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bf834645-d7fd-4415-83e6-afd8b71eadd3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf834645-d7fd-4415-83e6-afd8b71eadd3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1e8e9e4-1552-496a-ab31-306730988ca4' class='xr-var-data-in' type='checkbox'><label for='data-a1e8e9e4-1552-496a-ab31-306730988ca4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Unique identifier for each particle</dd><dt><span>cf_role :</span></dt><dd>trajectory_id</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 1.,  1.,  1., ...,  1.,  1.,  1.],
       [ 2.,  2.,  2., ..., nan, nan, nan],
       [ 3.,  3.,  3., ...,  3.,  3.,  3.],
       [ 4.,  4.,  4., ...,  4.,  4.,  4.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5a1d1a4f-d32c-4306-8096-4024c87ea988' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a1d1a4f-d32c-4306-8096-4024c87ea988' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1ebab1a-b2c1-494d-a31a-f291624ef23b' class='xr-var-data-in' type='checkbox'><label for='data-f1ebab1a-b2c1-494d-a31a-f291624ef23b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([[&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ...,                           &#x27;NaT&#x27;,
                                  &#x27;NaT&#x27;,                           &#x27;NaT&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f9f69059-908b-4b15-bda4-f1f6c43d7dd7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9f69059-908b-4b15-bda4-f1f6c43d7dd7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-951f24b8-153b-42b2-b52b-d5ab00bf0b30' class='xr-var-data-in' type='checkbox'><label for='data-951f24b8-153b-42b2-b52b-d5ab00bf0b30' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([[-18.5     , -18.536953, -18.572428, ..., -18.018187, -18.020998,
        -18.023403],
       [-18.25    , -18.332228, -18.405561, ..., -19.08771 , -19.095633,
        -19.103647],
       [-18.      , -18.056112, -18.106573, ...,        nan,        nan,
               nan],
       [-17.75    , -17.754168, -17.761713, ..., -19.141693, -19.159647,
        -19.17944 ],
       [-17.5     , -17.515566, -17.52634 , ..., -18.786823, -18.800255,
        -18.815973]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1b2b8c9a-e779-452c-be4c-3f91f87bba4e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b2b8c9a-e779-452c-be4c-3f91f87bba4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f60a9d4e-b5fd-478c-acf2-ef0d98392464' class='xr-var-data-in' type='checkbox'><label for='data-f60a9d4e-b5fd-478c-acf2-ef0d98392464' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([[147.     , 147.03894, 147.08493, ..., 146.15564, 146.15479, 146.15369],
       [147.25   , 147.34767, 147.46211, ..., 146.91318, 146.90988, 146.9066 ],
       [147.5    , 147.59273, 147.68913, ...,       nan,       nan,       nan],
       [147.75   , 147.79071, 147.83481, ..., 147.46735, 147.48056, 147.49503],
       [148.     , 148.02367, 148.0556 , ..., 146.8316 , 146.84024, 146.85043]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>z</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-664d0fca-49f9-45d9-99fa-d34eedf500cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-664d0fca-49f9-45d9-99fa-d34eedf500cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48a76dc8-574f-4b96-9f4e-954c7bffeb35' class='xr-var-data-in' type='checkbox'><label for='data-48a76dc8-574f-4b96-9f4e-954c7bffeb35' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ..., nan, nan, nan],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38c26bd9-1235-472f-a71f-584e25d8f54b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38c26bd9-1235-472f-a71f-584e25d8f54b' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>feature_type :</span></dt><dd>trajectory</dd><dt><span>Conventions :</span></dt><dd>CF-1.6/CF-1.7</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_Trajectory_Template_v2.0</dd><dt><span>parcels_version :</span></dt><dd>2.2.2</dd><dt><span>parcels_mesh :</span></dt><dd>spherical</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We will now use the <code class="docutils literal notranslate"><span class="pre">Xarray</span></code> <code class="docutils literal notranslate"><span class="pre">plot</span></code> function as we have done in the past…</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Check out this <a class="reference external" href="https://xarray-contrib.github.io/xarray-tutorial/scipy-tutorial/04_plotting_and_visualization.html">link</a> to see how to use <code class="docutils literal notranslate"><span class="pre">Xarray</span></code>’s convenient matplotlib-backed plotting interface to visualize your datasets!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure size</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Color from cmocean</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">speed</span>

<span class="c1"># Defining the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Axes with Cartopy projection</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># and extent</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">,</span> <span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plotting using Matplotlib </span>
<span class="c1"># We plot the PH at the surface at the final recorded time interval</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> 
    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Color bar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.045</span><span class="p">,</span> 
                    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">long_name</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
               <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Parcels evolution&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span>
         <span class="p">)</span>

<span class="c1"># Plot lat/lon grid </span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span> 

<span class="c1"># Add map features with Cartopy </span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span> 
                                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;face&#39;</span><span class="p">,</span> 
                                            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parcels</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">parcels</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">parcels</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> 
               <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parcels_32_0.png" src="../_images/parcels_32_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sampling-a-field-with-particles">
<h2>Sampling a Field with Particles<a class="headerlink" href="#sampling-a-field-with-particles" title="Permalink to this headline">¶</a></h2>
<p>One typical use case of particle simulations is to sample a Field (such as temperature, salinity, surface hight) along a particle trajectory. In <code class="docutils literal notranslate"><span class="pre">Parcels</span></code>, this is very easy to do, with a <code class="docutils literal notranslate"><span class="pre">custom</span> <span class="pre">Kernel</span></code>.</p>
<p>Let’s define the <code class="docutils literal notranslate"><span class="pre">FieldSet</span></code> as above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span>
            <span class="p">}</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we read in the fieldset using the <code class="docutils literal notranslate"><span class="pre">FieldSet.from_netcdf</span></code> function with the above-defined <code class="docutils literal notranslate"><span class="pre">filenames</span></code>, <code class="docutils literal notranslate"><span class="pre">variables</span></code> and <code class="docutils literal notranslate"><span class="pre">dimensions</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fieldset</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now add the field <code class="docutils literal notranslate"><span class="pre">temperature</span></code> to the <code class="docutils literal notranslate"><span class="pre">FieldSet</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
             <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
             <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">}</span>

<span class="n">variable</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">)</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>

<span class="n">field</span> <span class="o">=</span> <span class="n">Field</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>
<span class="n">fieldset</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now define a new <code class="docutils literal notranslate"><span class="pre">Particle</span> <span class="pre">class</span></code> that has an extra Variable: the <strong>temperature</strong>. We initialise this by sampling the <code class="docutils literal notranslate"><span class="pre">fieldset2.T</span></code> field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleParticle</span><span class="p">(</span><span class="n">JITParticle</span><span class="p">):</span>          <span class="c1"># Define a new particle class</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">fieldset</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Variable &#39;t&#39; initialised by sampling the temperature</span>
</pre></div>
</div>
</div>
</div>
<p>Now define a <code class="docutils literal notranslate"><span class="pre">ParticleSet</span></code> using the <code class="docutils literal notranslate"><span class="pre">from_line</span></code> method also used above. Plot the <code class="docutils literal notranslate"><span class="pre">pset</span></code> and print their temperature values <code class="docutils literal notranslate"><span class="pre">t</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pset</span> <span class="o">=</span> <span class="n">ParticleSet</span><span class="o">.</span><span class="n">from_line</span><span class="p">(</span><span class="n">fieldset</span><span class="o">=</span><span class="n">fieldset</span><span class="p">,</span> <span class="n">pclass</span><span class="o">=</span><span class="n">SampleParticle</span><span class="p">,</span> 
                             <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>               <span class="c1"># releasing 5 particles</span>
                             <span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mi">147</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.5</span><span class="p">),</span>   <span class="c1"># releasing on a line: the start longitude and latitude</span>
                             <span class="n">finish</span><span class="o">=</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.5</span><span class="p">),</span>  <span class="c1"># releasing on a line: the end longitude and latitude</span>
                             <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t values before execution:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pset</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Particle initialisation from field can be very slow as it is computed in scipy mode.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t values before execution: [28.90722, 29.133469, 29.18559, 29.126036, 29.002943]
</pre></div>
</div>
</div>
</div>
<p>Now create a custom function that samples the <code class="docutils literal notranslate"><span class="pre">fieldset.T</span></code> field at the particle location. Cast this function to a Kernel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SampleT</span><span class="p">(</span><span class="n">particle</span><span class="p">,</span> <span class="n">fieldset</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>  <span class="c1"># Custom function that samples fieldset2.T at particle location</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">fieldset</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">time</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">lon</span><span class="p">]</span>

<span class="n">k_sample</span> <span class="o">=</span> <span class="n">pset</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">SampleT</span><span class="p">)</span>    <span class="c1"># Casting the SampleT function to a kernel.</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, execute the pset with a combination of the <code class="docutils literal notranslate"><span class="pre">AdvectionRK4</span></code> and <code class="docutils literal notranslate"><span class="pre">SampleT</span></code> kernels, plot the pset and print their new temperature values <code class="docutils literal notranslate"><span class="pre">t</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_nc_temp</span> <span class="o">=</span> <span class="s1">&#39;CurrentParticlesTemp.nc&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">output_nc_temp</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_file_temp</span> <span class="o">=</span> <span class="n">pset</span><span class="o">.</span><span class="n">ParticleFile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">output_nc_temp</span><span class="p">,</span> 
                                <span class="n">outputdt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>

<span class="n">pset</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AdvectionRK4</span> <span class="o">+</span> <span class="n">k_sample</span><span class="p">,</span>    <span class="c1"># Add kernels using the + operator.</span>
             <span class="n">runtime</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
             <span class="n">dt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">output_file</span><span class="o">=</span><span class="n">output_file_temp</span><span class="p">,</span>
             <span class="n">recovery</span><span class="o">=</span><span class="p">{</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">ErrorOutOfBounds</span><span class="p">:</span> <span class="n">DeleteParticle</span><span class="p">})</span>

<span class="n">output_file_temp</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Compiled SampleParticleAdvectionRK4SampleT ==&gt; /tmp/parcels-1001/10e9ccb780cd6a66e3739935a7c2464b_0.so
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting-the-result">
<h3>Plotting the result<a class="headerlink" href="#plotting-the-result" title="Permalink to this headline">¶</a></h3>
<p>We can extract the netcdf file values…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parcels_temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">output_nc_temp</span><span class="p">)</span>
<span class="n">parcels_temp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (obs: 121, traj: 5)
Dimensions without coordinates: obs, traj
Data variables:
    trajectory  (traj, obs) float64 5.0 5.0 5.0 5.0 5.0 ... 9.0 9.0 9.0 9.0 9.0
    time        (traj, obs) datetime64[ns] 2017-12-31T14:00:00 ... 2018-01-30...
    lat         (traj, obs) float32 -18.5 -18.54 -18.57 ... -18.79 -18.8 -18.82
    lon         (traj, obs) float32 147.0 147.0 147.1 ... 146.8 146.8 146.9
    z           (traj, obs) float32 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0
    t           (traj, obs) float32 28.91 28.92 28.91 ... 28.85 28.95 29.04
Attributes:
    feature_type:           trajectory
    Conventions:            CF-1.6/CF-1.7
    ncei_template_version:  NCEI_NetCDF_Trajectory_Template_v2.0
    parcels_version:        2.2.2
    parcels_mesh:           spherical</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c8998dcd-d8fb-4843-bd84-e0d90f434b07' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c8998dcd-d8fb-4843-bd84-e0d90f434b07' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>obs</span>: 121</li><li><span>traj</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5e15349a-b318-4626-835b-83e017afe979' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5e15349a-b318-4626-835b-83e017afe979' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-6571cbe0-4ea0-49cc-9cdf-5db5d50d51cd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6571cbe0-4ea0-49cc-9cdf-5db5d50d51cd' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>trajectory</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-985cf7ff-c081-4a9c-a18e-ac132a2e6d9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-985cf7ff-c081-4a9c-a18e-ac132a2e6d9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c8ceaeaa-ab14-41fa-bd1e-460b909bc3e4' class='xr-var-data-in' type='checkbox'><label for='data-c8ceaeaa-ab14-41fa-bd1e-460b909bc3e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Unique identifier for each particle</dd><dt><span>cf_role :</span></dt><dd>trajectory_id</dd></dl></div><div class='xr-var-data'><pre>array([[ 5.,  5.,  5., ...,  5.,  5.,  5.],
       [ 6.,  6.,  6., ...,  6.,  6.,  6.],
       [ 7.,  7.,  7., ..., nan, nan, nan],
       [ 8.,  8.,  8., ...,  8.,  8.,  8.],
       [ 9.,  9.,  9., ...,  9.,  9.,  9.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0e08ea4c-3692-48af-a3ed-471ed2dd5e90' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e08ea4c-3692-48af-a3ed-471ed2dd5e90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e45aa3d0-4822-4e7b-9e92-8492a46c5753' class='xr-var-data-in' type='checkbox'><label for='data-e45aa3d0-4822-4e7b-9e92-8492a46c5753' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([[&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ...,                           &#x27;NaT&#x27;,
                                  &#x27;NaT&#x27;,                           &#x27;NaT&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T20:00:00.000000000&#x27;,
        &#x27;2018-01-01T02:00:00.000000000&#x27;, ..., &#x27;2018-01-30T02:00:00.000000000&#x27;,
        &#x27;2018-01-30T08:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a0dcbb23-b17c-4db6-a0a8-8a78df204a99' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0dcbb23-b17c-4db6-a0a8-8a78df204a99' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c29a8b26-9a6b-4da8-acae-cb3212a40ca5' class='xr-var-data-in' type='checkbox'><label for='data-c29a8b26-9a6b-4da8-acae-cb3212a40ca5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([[-18.5     , -18.536953, -18.572428, ..., -18.018187, -18.020998,
        -18.023403],
       [-18.25    , -18.332228, -18.405561, ..., -19.08771 , -19.095633,
        -19.103647],
       [-18.      , -18.056112, -18.106573, ...,        nan,        nan,
               nan],
       [-17.75    , -17.754168, -17.761713, ..., -19.141693, -19.159647,
        -19.17944 ],
       [-17.5     , -17.515566, -17.52634 , ..., -18.786823, -18.800255,
        -18.815973]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-48d2e043-52aa-4ffa-a8d3-b023282c3eca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-48d2e043-52aa-4ffa-a8d3-b023282c3eca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7ffddc2-1f89-4fa3-9b2f-1410c28d07bd' class='xr-var-data-in' type='checkbox'><label for='data-f7ffddc2-1f89-4fa3-9b2f-1410c28d07bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([[147.     , 147.03894, 147.08493, ..., 146.15564, 146.15479, 146.15369],
       [147.25   , 147.34767, 147.46211, ..., 146.91318, 146.90988, 146.9066 ],
       [147.5    , 147.59273, 147.68913, ...,       nan,       nan,       nan],
       [147.75   , 147.79071, 147.83481, ..., 147.46735, 147.48056, 147.49503],
       [148.     , 148.02367, 148.0556 , ..., 146.8316 , 146.84024, 146.85043]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>z</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-733ebea1-e0a4-415a-9d72-5dde9f7f8484' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-733ebea1-e0a4-415a-9d72-5dde9f7f8484' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9181980b-c4ce-4c72-b9b5-354469e20a07' class='xr-var-data-in' type='checkbox'><label for='data-9181980b-c4ce-4c72-b9b5-354469e20a07' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ..., nan, nan, nan],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-92e64a88-ae02-4f73-bb51-0ad5d4ff1d59' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92e64a88-ae02-4f73-bb51-0ad5d4ff1d59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b9b6f32-883c-44ad-b6ab-255d2050e798' class='xr-var-data-in' type='checkbox'><label for='data-7b9b6f32-883c-44ad-b6ab-255d2050e798' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>t</dd><dt><span>units :</span></dt><dd>unknown</dd></dl></div><div class='xr-var-data'><pre>array([[28.90722 , 28.916945, 28.908466, ..., 29.401653, 29.47714 , 29.552055],
       [29.133469, 29.104572, 29.055515, ..., 29.095577, 29.188328, 29.279562],
       [29.18559 , 29.12668 , 29.089144, ...,       nan,       nan,       nan],
       [29.126036, 29.110771, 29.094656, ..., 28.989418, 29.122204, 29.246988],
       [29.002943, 28.962803, 28.936161, ..., 28.853973, 28.94527 , 29.044361]],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-df7f1491-c81b-4ebb-80f7-5a0961630f3e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-df7f1491-c81b-4ebb-80f7-5a0961630f3e' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>feature_type :</span></dt><dd>trajectory</dd><dt><span>Conventions :</span></dt><dd>CF-1.6/CF-1.7</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_Trajectory_Template_v2.0</dd><dt><span>parcels_version :</span></dt><dd>2.2.2</dd><dt><span>parcels_mesh :</span></dt><dd>spherical</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>And plot the resulting parcels output on a map:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure size</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Color from cmocean</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">speed</span>

<span class="c1"># Defining the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Axes with Cartopy projection</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># and extent</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">,</span> <span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plotting using Matplotlib </span>
<span class="c1"># We plot the PH at the surface at the final recorded time interval</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> 
    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Color bar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.045</span><span class="p">,</span> 
                    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">long_name</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
               <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Parcels evolution coloured by surface temperature&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span>
         <span class="p">)</span>

<span class="c1"># Plot lat/lon grid </span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span> 

<span class="c1"># Add map features with Cartopy </span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span> 
                                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;face&#39;</span><span class="p">,</span> 
                                            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">distmin</span> <span class="o">=</span> <span class="n">parcels_temp</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">distmax</span> <span class="o">=</span> <span class="n">parcels_temp</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parcels_temp</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">parcels_temp</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">parcels_temp</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> 
               <span class="n">c</span><span class="o">=</span><span class="n">parcels_temp</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
               <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">distmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">distmax</span><span class="p">,</span> 
               <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Color bar</span>
<span class="n">cbar2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.045</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Surface temperature in degree C&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> 
               <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parcels_52_0.png" src="../_images/parcels_52_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="calculating-distance-travelled">
<h2>Calculating distance travelled<a class="headerlink" href="#calculating-distance-travelled" title="Permalink to this headline">¶</a></h2>
<p>As a second example of what custom kernels can do, we will now show how to create a kernel that logs the total distance that particles have travelled.</p>
<p>First, we need to create a new <code class="docutils literal notranslate"><span class="pre">Particle</span> <span class="pre">class</span></code> that includes three extra variables. The distance variable will be written to output, but the auxiliary variables <code class="docutils literal notranslate"><span class="pre">prev_lon</span></code> and <code class="docutils literal notranslate"><span class="pre">prev_lat</span></code> won’t be written to output (can be controlled using the <code class="docutils literal notranslate"><span class="pre">to_write</span></code> keyword)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DistParticle</span><span class="p">(</span><span class="n">JITParticle</span><span class="p">):</span>  <span class="c1"># Define a new particle class that contains three extra variables</span>
    
    <span class="n">distance</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>  <span class="c1"># the distance travelled</span>
    <span class="n">prev_lon</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;prev_lon&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">to_write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">initial</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>  <span class="c1"># the previous longitude</span>
    <span class="n">prev_lat</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;prev_lat&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">to_write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">initial</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span>  <span class="c1"># the previous latitude.</span>
</pre></div>
</div>
</div>
</div>
<p>Now define a new function <code class="docutils literal notranslate"><span class="pre">TotalDistance</span></code> that calculates the sum of Euclidean distances between the old and new locations in each <code class="docutils literal notranslate"><span class="pre">RK4</span></code> step:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">TotalDistance</span><span class="p">(</span><span class="n">particle</span><span class="p">,</span> <span class="n">fieldset</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
    
    <span class="c1"># Calculate the distance in latitudinal direction (using 1.11e2 kilometer per degree latitude)</span>
    <span class="n">lat_dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">particle</span><span class="o">.</span><span class="n">lat</span> <span class="o">-</span> <span class="n">particle</span><span class="o">.</span><span class="n">prev_lat</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.11e2</span>
    <span class="c1"># Calculate the distance in longitudinal direction, using cosine(latitude) - spherical earth</span>
    <span class="n">lon_dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">particle</span><span class="o">.</span><span class="n">lon</span> <span class="o">-</span> <span class="n">particle</span><span class="o">.</span><span class="n">prev_lon</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.11e2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">particle</span><span class="o">.</span><span class="n">lat</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
    <span class="c1"># Calculate the total Euclidean distance travelled by the particle</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">distance</span> <span class="o">+=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">lon_dist</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">lat_dist</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">particle</span><span class="o">.</span><span class="n">prev_lon</span> <span class="o">=</span> <span class="n">particle</span><span class="o">.</span><span class="n">lon</span>  <span class="c1"># Set the stored values for next iteration.</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">prev_lat</span> <span class="o">=</span> <span class="n">particle</span><span class="o">.</span><span class="n">lat</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here it is assumed that the latitude and longitude are measured in degrees North and East, respectively. However, some datasets give them measured in (kilo)meters, in which case we must not include the factor 1.11e2.</p>
</div>
<p>We will run the <code class="docutils literal notranslate"><span class="pre">TotalDistance</span></code> function on a <code class="docutils literal notranslate"><span class="pre">ParticleSet</span></code> containing the five particles within the eReefs fieldset similar to the one we did above.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">pclass=DistParticle</span></code> in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="n">data_name</span><span class="p">,</span>
            <span class="p">}</span>

<span class="n">variables</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span>
             <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="s1">&#39;v&#39;</span><span class="p">}</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
              <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>

<span class="n">fieldset</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span>

<span class="n">pset</span> <span class="o">=</span> <span class="n">ParticleSet</span><span class="o">.</span><span class="n">from_line</span><span class="p">(</span><span class="n">fieldset</span><span class="o">=</span><span class="n">fieldset</span><span class="p">,</span> 
                             <span class="n">pclass</span><span class="o">=</span><span class="n">DistParticle</span><span class="p">,</span>
                             <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>               <span class="c1"># releasing 5 particles</span>
                             <span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mi">147</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.5</span><span class="p">),</span>   <span class="c1"># releasing on a line: the start longitude and latitude</span>
                             <span class="n">finish</span><span class="o">=</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.5</span><span class="p">),</span>  <span class="c1"># releasing on a line: the end longitude and latitude</span>
                             <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again we define a new kernel to include the function written above and execute the <code class="docutils literal notranslate"><span class="pre">ParticleSet</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_nc_dist</span> <span class="o">=</span> <span class="s1">&#39;CurrentParticlesDist.nc&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">output_nc_dist</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">file_dist</span> <span class="o">=</span> <span class="n">pset</span><span class="o">.</span><span class="n">ParticleFile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">output_nc_dist</span><span class="p">,</span> 
                                <span class="n">outputdt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">k_dist</span> <span class="o">=</span> <span class="n">pset</span><span class="o">.</span><span class="n">Kernel</span><span class="p">(</span><span class="n">TotalDistance</span><span class="p">)</span>  <span class="c1"># Casting the TotalDistance function to a kernel.</span>

<span class="n">pset</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AdvectionRK4</span> <span class="o">+</span> <span class="n">k_dist</span><span class="p">,</span>  <span class="c1"># Add kernels using the + operator.</span>
             <span class="n">runtime</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
             <span class="n">dt</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">output_file</span><span class="o">=</span><span class="n">file_dist</span><span class="p">,</span>
             <span class="n">recovery</span><span class="o">=</span><span class="p">{</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">ErrorOutOfBounds</span><span class="p">:</span> <span class="n">DeleteParticle</span><span class="p">})</span>

<span class="n">file_dist</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Compiled DistParticleAdvectionRK4TotalDistance ==&gt; /tmp/parcels-1001/db33ec2ecce7d6d05221b0c0912c7346_0.so
</pre></div>
</div>
</div>
</div>
<p>We can now print the distance in km that each particle has travelled:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">distance</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pset</span><span class="p">])</span> <span class="c1"># the distances in km travelled by the particles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[278.97974, 459.3084, 507.74344, 508.9902]
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Plotting the result<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We can extract the netcdf file values…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parcels_dist</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">output_nc_dist</span><span class="p">)</span>
<span class="n">parcels_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (obs: 721, traj: 5)
Dimensions without coordinates: obs, traj
Data variables:
    trajectory  (traj, obs) float64 10.0 10.0 10.0 10.0 ... 14.0 14.0 14.0 14.0
    time        (traj, obs) datetime64[ns] 2017-12-31T14:00:00 ... 2018-01-30...
    lat         (traj, obs) float32 -18.5 -18.51 -18.51 ... -18.81 -18.81 -18.82
    lon         (traj, obs) float32 147.0 147.0 147.0 ... 146.8 146.8 146.9
    z           (traj, obs) float32 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0
    distance    (traj, obs) float32 0.0 0.9391 1.884 2.838 ... 508.3 508.6 509.0
Attributes:
    feature_type:           trajectory
    Conventions:            CF-1.6/CF-1.7
    ncei_template_version:  NCEI_NetCDF_Trajectory_Template_v2.0
    parcels_version:        2.2.2
    parcels_mesh:           spherical</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-59c1362a-d860-44d7-9dd2-f843e41cccf6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-59c1362a-d860-44d7-9dd2-f843e41cccf6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>obs</span>: 721</li><li><span>traj</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-45d2139a-0a2b-4de6-a76b-5846fa8c250c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-45d2139a-0a2b-4de6-a76b-5846fa8c250c' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-d5dfce59-183d-4a4f-8262-407b8bfe3f63' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d5dfce59-183d-4a4f-8262-407b8bfe3f63' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>trajectory</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f8c0d846-6c20-42c7-816a-ddd17ecde6a0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f8c0d846-6c20-42c7-816a-ddd17ecde6a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f46caccf-d57c-4e37-a01e-f31be76b72c8' class='xr-var-data-in' type='checkbox'><label for='data-f46caccf-d57c-4e37-a01e-f31be76b72c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Unique identifier for each particle</dd><dt><span>cf_role :</span></dt><dd>trajectory_id</dd></dl></div><div class='xr-var-data'><pre>array([[10., 10., 10., ..., 10., 10., 10.],
       [11., 11., 11., ..., 11., 11., 11.],
       [12., 12., 12., ..., nan, nan, nan],
       [13., 13., 13., ..., 13., 13., 13.],
       [14., 14., 14., ..., 14., 14., 14.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e8afeaa0-b2d1-42ad-9094-ee31102e489f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8afeaa0-b2d1-42ad-9094-ee31102e489f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b98779d-7cbb-4fc9-b3c6-dc011cb219dc' class='xr-var-data-in' type='checkbox'><label for='data-1b98779d-7cbb-4fc9-b3c6-dc011cb219dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([[&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T15:00:00.000000000&#x27;,
        &#x27;2017-12-31T16:00:00.000000000&#x27;, ..., &#x27;2018-01-30T12:00:00.000000000&#x27;,
        &#x27;2018-01-30T13:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T15:00:00.000000000&#x27;,
        &#x27;2017-12-31T16:00:00.000000000&#x27;, ..., &#x27;2018-01-30T12:00:00.000000000&#x27;,
        &#x27;2018-01-30T13:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T15:00:00.000000000&#x27;,
        &#x27;2017-12-31T16:00:00.000000000&#x27;, ...,                           &#x27;NaT&#x27;,
                                  &#x27;NaT&#x27;,                           &#x27;NaT&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T15:00:00.000000000&#x27;,
        &#x27;2017-12-31T16:00:00.000000000&#x27;, ..., &#x27;2018-01-30T12:00:00.000000000&#x27;,
        &#x27;2018-01-30T13:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;],
       [&#x27;2017-12-31T14:00:00.000000000&#x27;, &#x27;2017-12-31T15:00:00.000000000&#x27;,
        &#x27;2017-12-31T16:00:00.000000000&#x27;, ..., &#x27;2018-01-30T12:00:00.000000000&#x27;,
        &#x27;2018-01-30T13:00:00.000000000&#x27;, &#x27;2018-01-30T14:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-44b78b3b-0ebf-48ce-ba99-f95893a40ffc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44b78b3b-0ebf-48ce-ba99-f95893a40ffc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f8b6083-b35f-4f53-810b-075ca9c7e728' class='xr-var-data-in' type='checkbox'><label for='data-8f8b6083-b35f-4f53-810b-075ca9c7e728' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([[-18.5     , -18.506329, -18.512539, ..., -18.022646, -18.023035,
        -18.023403],
       [-18.25    , -18.263754, -18.277433, ..., -19.101013, -19.10234 ,
        -19.103647],
       [-18.      , -18.009752, -18.019323, ...,        nan,        nan,
               nan],
       [-17.75    , -17.750454, -17.751007, ..., -19.17263 , -19.176006,
        -19.17944 ],
       [-17.5     , -17.502817, -17.50557 , ..., -18.8105  , -18.813204,
        -18.815973]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-808e1984-3b3a-458b-84e8-4b1fa91a9c05' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-808e1984-3b3a-458b-84e8-4b1fa91a9c05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d370118-0683-4ed5-ba38-91c220107703' class='xr-var-data-in' type='checkbox'><label for='data-1d370118-0683-4ed5-ba38-91c220107703' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([[147.     , 147.00592, 147.01205, ..., 146.15405, 146.15387, 146.15369],
       [147.25   , 147.26562, 147.28152, ..., 146.90768, 146.90714, 146.9066 ],
       [147.5    , 147.51506, 147.53032, ...,       nan,       nan,       nan],
       [147.75   , 147.75659, 147.76323, ..., 147.49008, 147.49246, 147.49503],
       [148.     , 148.00334, 148.00691, ..., 146.84683, 146.8486 , 146.85043]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>z</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-64458f70-08ca-411a-ab6b-2118abe40fdc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64458f70-08ca-411a-ab6b-2118abe40fdc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d79ec1c8-75b8-4391-b522-847926c94362' class='xr-var-data-in' type='checkbox'><label for='data-d79ec1c8-75b8-4391-b522-847926c94362' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ..., nan, nan, nan],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>distance</span></div><div class='xr-var-dims'>(traj, obs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-32874fa7-4675-4ec4-b3e5-a609b18a4abc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-32874fa7-4675-4ec4-b3e5-a609b18a4abc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a32d302-2cee-4b7c-ab62-c2f95ab9afb9' class='xr-var-data-in' type='checkbox'><label for='data-4a32d302-2cee-4b7c-ab62-c2f95ab9afb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd></dd><dt><span>standard_name :</span></dt><dd>distance</dd><dt><span>units :</span></dt><dd>unknown</dd></dl></div><div class='xr-var-data'><pre>array([[0.000000e+00, 9.391081e-01, 1.883644e+00, ..., 2.788873e+02,
        2.789345e+02, 2.789797e+02],
       [0.000000e+00, 2.245824e+00, 4.507293e+00, ..., 4.589945e+02,
        4.591527e+02, 4.593084e+02],
       [0.000000e+00, 1.923405e+00, 3.852935e+00, ...,          nan,
                 nan,          nan],
       [0.000000e+00, 6.986855e-01, 1.403066e+00, ..., 5.068269e+02,
        5.072771e+02, 5.077434e+02],
       [0.000000e+00, 4.721994e-01, 9.582659e-01, ..., 5.082744e+02,
        5.086276e+02, 5.089902e+02]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f02ce4f2-8997-49bd-b722-39deff0c5154' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f02ce4f2-8997-49bd-b722-39deff0c5154' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>feature_type :</span></dt><dd>trajectory</dd><dt><span>Conventions :</span></dt><dd>CF-1.6/CF-1.7</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_Trajectory_Template_v2.0</dd><dt><span>parcels_version :</span></dt><dd>2.2.2</dd><dt><span>parcels_mesh :</span></dt><dd>spherical</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>And plot the resulting parcels output on a map:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figure size</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Color from cmocean</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">speed</span>

<span class="c1"># Defining the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Axes with Cartopy projection</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># and extent</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">,</span> <span class="n">min_lat</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plotting using Matplotlib </span>
<span class="c1"># We plot the PH at the surface at the final recorded time interval</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> 
    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Color bar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.045</span><span class="p">,</span> 
                    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">long_name</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">ds_hydro_clip</span><span class="o">.</span><span class="n">mean_cur</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
               <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Parcels evolution coloured by travelled distance&#39;</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span>
         <span class="p">)</span>

<span class="c1"># Plot lat/lon grid </span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span> 

<span class="c1"># Add map features with Cartopy </span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span> 
                                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;face&#39;</span><span class="p">,</span> 
                                            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">distmin</span> <span class="o">=</span> <span class="n">parcels_dist</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">distmax</span> <span class="o">=</span> <span class="n">parcels_dist</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parcels_dist</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">parcels_dist</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">parcels_dist</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> 
               <span class="n">c</span><span class="o">=</span><span class="n">parcels_dist</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> 
               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">distmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">distmax</span><span class="p">,</span> 
               <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Color bar</span>
<span class="n">cbar2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.045</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Travelled distance in km&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> 
               <span class="n">labelpad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/parcels_66_0.png" src="../_images/parcels_66_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://nbviewer.jupyter.org/github/OceanParcels/parcels/blob/master/parcels/examples/tutorial_output.ipynb">Tutorial</a> on how to analyse Parcels output</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6-addson"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../5-xarray/examples/app.html" title="previous page">PyViz Application</a>
    <a class='right-next' id="next-link" href="libraries.html" title="next page">Other libraries of interest</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tristan Salles<br/>
        
            &copy; Copyright 2020-2022.<br/>
          <div class="extra_footer">
            <p>
<a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">
  <img align="right" class="margin" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by.svg" width="88px">
</a>
These lecture notes and exercises are licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International (CC BY 4.0) license</a>.
<br>
&copy; Copyright 2020-2022.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>